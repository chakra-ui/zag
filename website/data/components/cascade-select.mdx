---
title: Cascade Select
description: Using the cascade select machine in your project.
package: "@zag-js/cascade-select"
---

A Cascade Select component allows users to select from hierarchical data through
multiple linked levels of dropdown menus.

<Resources pkg="@zag-js/cascade-select" />

<Showcase id="CascadeSelect" />

**Features**

- Support for hierarchical data with unlimited depth levels
- Full keyboard navigation across all levels with arrow keys
- Support for single and multiple selections
- Support for both click and hover triggering modes
- Support for looping keyboard navigation
- Built-in accessibility with ARIA roles and keyboard interactions
- Support for disabled items and read-only state
- Form integration with hidden input element
- Support for Right to Left direction.

## Installation

To use the cascade select machine in your project, run the following command in
your command line:

<CodeSnippet id="cascade-select/installation.mdx" />

## Anatomy

To set up the cascade select correctly, you'll need to understand its anatomy
and how we name its parts.

> Each part includes a `data-part` attribute to help identify them in the DOM.

<Anatomy id="cascade-select" />

## Usage

First, import the cascade select package into your project

```jsx
import * as cascadeSelect from "@zag-js/cascade-select"
```

The cascade select package exports these functions:

- `machine` â€” The state machine logic for the cascade select.
- `connect` â€” The function that translates the machine's state to JSX
  attributes and event handlers.
- `collection` - The function that creates a tree collection from a tree node.

### Create the collection

Use the `collection` function to create a tree collection from your hierarchical
data. Pass a `rootNode` along with functions to extract each node's value,
string label, and children.

```ts
import * as cascadeSelect from "@zag-js/cascade-select"

interface Node {
  label: string
  value: string
  children?: Node[]
}

const collection = cascadeSelect.collection<Node>({
  nodeToValue: (node) => node.value,
  nodeToString: (node) => node.label,
  nodeToChildren: (node) => node.children,
  rootNode: {
    label: "ROOT",
    value: "ROOT",
    children: [
      {
        label: "North America",
        value: "north-america",
        children: [
          {
            label: "United States",
            value: "us",
            children: [
              { label: "New York", value: "ny" },
              { label: "California", value: "ca" },
            ],
          },
          { label: "Canada", value: "canada" },
        ],
      },
      {
        label: "Africa",
        value: "africa",
        children: [
          { label: "Nigeria", value: "ng" },
          { label: "Kenya", value: "ke" },
        ],
      },
    ],
  },
})
```

### Create the cascade select

> You'll need to provide a unique `id` to the `useMachine` hook. This is used
> to ensure that every part has a unique identifier.

Pass the collection to the machine to create the cascade select ðŸ”¥

<CodeSnippet id="cascade-select/usage.mdx" />

### Setting the initial value

Use the `defaultValue` property to set the initial value of the cascade select.

> The `value` property must be an array of string paths. Each path is an array
> of values from the root to the selected leaf item.

```jsx {4}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  defaultValue: [["north-america", "us", "ny"]],
})
```

### Selecting multiple values

To allow selecting multiple values, set the `multiple` property to `true`.

```jsx {4}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  multiple: true,
})
```

### Hover triggering

By default, items are highlighted when clicked. To highlight items on hover
instead (like a traditional cascading menu), set the `highlightTrigger` property
to `"hover"`.

```jsx {4}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  highlightTrigger: "hover",
})
```

### Allowing parent selection

By default, only leaf nodes (items without children) can be selected. To allow
parent (branch) nodes to also be selectable, set `allowParentSelection` to
`true`.

```jsx {4}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  allowParentSelection: true,
})
```

### Close on select

This behaviour ensures that the menu is closed when an item is selected and is
`true` by default. To keep the dropdown open after selection, set the
`closeOnSelect` property to `false`.

```jsx {4}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  closeOnSelect: false,
})
```

### Looping the keyboard navigation

When navigating with the cascade select using the arrow down and up keys, the
navigation stops at the first and last items. To loop navigation back to the
first or last item, set `loopFocus: true` in the machine's context.

```jsx {4}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  loopFocus: true,
})
```

### Listening for highlight changes

When an item is highlighted with the pointer or keyboard, use the
`onHighlightChange` to listen for the change and do something with it.

```jsx {3-6}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  onHighlightChange(details) {
    // details => { value: string[], items: Item[] }
    console.log(details)
  },
})
```

### Listening for selection changes

When an item is selected, use the `onValueChange` property to listen for the
change and do something with it.

```jsx {4-7}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  onValueChange(details) {
    // details => { value: string[][], items: Item[][] }
    console.log(details)
  },
})
```

### Listening for open and close events

When the cascade select is opened or closed, the `onOpenChange` callback is
called. You can listen for these events and do something with it.

```jsx {4-7}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  onOpenChange(details) {
    // details => { open: boolean }
    console.log(details)
  },
})
```

### Usage within a form

To use cascade select within a form, pass the `name` property to the machine
context. A hidden input element is automatically rendered using
`getHiddenInputProps()`.

```jsx {4}
const service = useMachine(cascadeSelect.machine, {
  id: useId(),
  collection,
  name: "location",
})

// In your JSX
<input {...api.getHiddenInputProps()} />
```

## Styling guide

Earlier, we mentioned that each cascade select part has a `data-part` attribute
added to them to select and style them in the DOM.

### Open and closed state

When the cascade select is open, the trigger and content is given a `data-state`
attribute.

```css
[data-part="trigger"][data-state="open|closed"] {
  /* styles for open or closed state */
}

[data-part="content"][data-state="open|closed"] {
  /* styles for open or closed state */
}
```

### Selected state

Items are given a `data-state` attribute, indicating whether they are selected.

```css
[data-part="item"][data-state="checked|unchecked"] {
  /* styles for selected or unselected state */
}
```

### Highlighted state

When an item is highlighted, via keyboard navigation or pointer, it is given a
`data-highlighted` attribute.

```css
[data-part="item"][data-highlighted] {
  /* styles for highlighted state */
}
```

### Branch items

When an item has children (is a branch node), it is given a `data-has-children`
attribute.

```css
[data-part="item"][data-has-children] {
  /* styles for items with children (branch nodes) */
}
```

### Invalid state

When the cascade select is invalid, the label and trigger is given a
`data-invalid` attribute.

```css
[data-part="label"][data-invalid] {
  /* styles for invalid state */
}

[data-part="trigger"][data-invalid] {
  /* styles for invalid state */
}
```

### Disabled state

When the cascade select is disabled, the trigger and label is given a
`data-disabled` attribute.

```css
[data-part="trigger"][data-disabled] {
  /* styles for disabled state */
}

[data-part="label"][data-disabled] {
  /* styles for disabled label state */
}

[data-part="item"][data-disabled] {
  /* styles for disabled item state */
}
```

### Empty state

When no option is selected, the trigger is given a `data-placeholder-shown`
attribute.

```css
[data-part="trigger"][data-placeholder-shown] {
  /* styles for empty state */
}
```

## Methods and Properties

### Machine Context

The cascade select machine exposes the following context properties:

<ContextTable name="cascade-select" />

### Machine API

The cascade select `api` exposes the following methods:

<ApiTable name="cascade-select" />

### Data Attributes

<DataAttrTable name="cascade-select" />

### CSS Variables

<CssVarTable name="cascade-select" />

## Accessibility

Adheres to the
[ListBox WAI-ARIA design pattern](https://www.w3.org/WAI/ARIA/apg/patterns/listbox).

### Keyboard Interactions

<KeyboardTable name="cascade-select" />
